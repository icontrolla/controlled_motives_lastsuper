<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
  <meta charset="UTF-8">
  <meta name="csrf-token" content="{{ csrf_token }}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Montserrat&family=Roboto&display=swap" rel="stylesheet">
  {% load static %}
  <link rel="stylesheet" href="{% static 'profiles/gallery/styles.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <title>Controlled Motives</title>
  <style>
    body {
      margin: 0px 150px ;
      top: %;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      color: #333;
      background-color: #f9f9f9;
    }
    .header-container {
    position: sticky;
    top: 0;
    bottom: 150px;
    z-index: 1000;
    display: flex;
    height: 40px;
    margin: -14%;
    width: 130%;
    align-items: center;
    padding: 10px 20px;
    background: white; /* ✅ Ensures a white background */
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* ✅ Adds subtle shadow */
    }

    .menu-items a {
    display: flex;
    align-items: center;
    padding: 10px;
    color: #fff;
    text-decoration: none;
    font-size: 18px;
}

/* Add icon margin and hide text on collapse */
.menu-items a i {
    margin-right: 10px;
}

/* When sidebar is collapsed, show only icons */
.sidebar.collapsed {
    width: 60px;
}

.sidebar.collapsed .menu-items a span {
    display: none; /* Hide text when sidebar is collapsed */
}

/* Show text and icons when sidebar is expanded */
.sidebar:not(.collapsed) .menu-items a span {
    margin-left: 10px; /* Add space between icon and text */
}

/* Hover effect */
.menu-items a:hover {
    background-color: #575757;
}

/* Add a button to toggle the sidebar (optional) */
.sidebar {
    position: absolute;
    top: 20px;
    right: 30px;
    background-color: #333;
    color: #fff;
    padding: 10px;
    cursor: pointer;
}

    .menu-items a i {
        margin-right: 0px;
    }

    .menu-items a:hover {
        background-color: #575757;
    }

    .menu-btn {
    display: flex;
    background: transparent;
    border: none;
    cursor: pointer;
    margin: 0 14px;
    }



    header {
      position: sticky;
      top: 0;
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 30px;
      border-radius: 50px;
      width: 50%;
      margin: 0 25%;
      border-bottom: 4px solid #eaeaea;
      background:#3d3a38;
      color: white;

    }

    header .logo {
      font-size: 1.0rem;
      font-family: 'ControlledFont';
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.1rem;

    }

    header nav a {
      margin-left: 20px;
      text-decoration: none;
      color: white;
      font-size: 0.8rem;
      transition: color 0.3s;
    }

    header nav a:hover {
      color: #0070f3;
    }


    /* Ensure text is visible on dark backgrounds */

    .search-btn {
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 0.1rem;
      margin-left: 10px;
      color: inherit; /* Adapts to header text color */
      transition: color 0.3s;
    }

    .search-btn:hover {
      color: #0070f3;
    }

    /* Expanded Search Input */
    .search-container.active .search-input {
      width: 150px;
      padding: 8px 12px;
      opacity: 1;
    }

    .hero {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: 50px 20px;
      background: white;
    }

    .hero h1 {
      font-size: 2.5rem;
      font-weight: 600;
      margin-bottom: 20px;
      letter-spacing: -0.02em;
    }

    .hero p {
      font-size: 1.2rem;
      line-height: 1.6;
      margin-bottom: 30px;
      color: #666;
    }

    .hero button {
      padding: 10px 20px;
      font-size: 1rem;
      color: white;
      background-color: #0070f3;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .hero button:hover {
      background-color: #005bb5;
    }

    .section {

    }

    .info {
            display: none;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            text-align: center;
        }

        .info button {
            margin-top: 10px;
            padding: 5px 10px;
            background: red;
            color: white;
            border: none;
            cursor: pointer;
        }

    .section h2 {
      font-size: 2rem;
      font-weight: 500;
      margin-bottom: 20px;
      text-align: center;
    }

    /* Disable background scrolling when modal is open */
    body.modal-open {
        overflow: hidden;
    }

    .modal {
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background-color: rgba(0, 0, 0, 0.7); /* Dark overlay */
        backdrop-filter: blur(5px); /* Smooth blur effect */
        display: flex;
        justify-content: center;
        align-items: center;
}

.modal-content {
    background: #111;
    color: white;
    left: 450px;
    padding: 20px 30px;
    border-radius: 10px;
    overflow-y: auto;
    align-items: center;
    max-width: 650px;
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
    text-align: left;
    animation: fadeIn 0.3s ease-in-out;
}

.modal-content img {
    max-width: 100%;
    border-radius: 8px;
    margin-bottom: 15px;
}

.close-btn {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 24px;
    cursor: pointer;
    color: white;
    transition: 0.2s;
}

.close-btn:hover {
    color: red;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
}

    .grid {
      display: grid;
      grid-template-columns: repeat(3, 2fr);
      gap: 20px;
      margin-top: 40px;
    }

    .artwork-gallery {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    background-color: white;
    }

.artwork-card {
    width: 390px;
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
}

.artwork-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
}

.artwork-card img {
    width: 100%;
    height: 280px;
    object-fit: cover;
}

.artwork-info {
    padding: 15px;
}

.artwork-title {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 10px;
    color: #333;
}

.artwork-description {
    font-size: 1rem;
    color: #666;
    margin-bottom: 10px;
}

.artwork-meta {
    display: flex;
    justify-content: space-between;
    font-size: 0.9rem;
    color: #888;
}

.artwork-meta .meta-item i {
    margin-right: 5px;
}

.artwork-actions {
    padding: 0 15px 15px;
    display: flex;
    justify-content: center;
}
.flower-button {
    background: linear-gradient(135deg, #ff9800, #ff5722);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.3s ease, transform 0.2s ease;
}

.flower-button:hover {
    background: linear-gradient(135deg, #ff5722, #d84315);
    transform: scale(1.05);
}

.flower-button:disabled {
    background: #ccc;
    cursor: not-allowed;
    transform: none;
}


    footer {
      text-align: center;
      padding: 40px 20px;
      border-top: 1px solid #eaeaea;
      background: white;
    }

    footer p {
      font-size: 0.9rem;
      color: #666;
    }

    @font-face {
        font-family: 'ControlledFont';
        src: url("{% static 'fonts/controlledfont.otf' %}") format('truetype');
    }
    /* Modal Styles */
.modal {
    z-index: 1000;
    top:50px;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background-color: rgba(0, 0, 0, 0.7); /* Dark overlay */
    backdrop-filter: blur(5px); /* Smooth blur effect */
    display: flex;
    justify-content: center;
    align-items: center;
}

.modal-content {
    display: flex;
    background: white;
    color: black;
    border-radius: 10px;
    align-items: center;
    width: 100%;
    height: 60%;
    font-size: 13px;
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
    overflow: hidden;
    animation: fadeIn 0.3s ease-in-out;
}

.modal-content img {
    max-width: 70%;
    height: 70%;
    border-radius: 8px;

    margin-bottom: 15px;
}

#artworkModal {
    display: none; /* Ensure modal is hidden by default */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    justify-content: center;
    align-items: center;
}

.close-btn {
    position: absolute;
    top: 15px;
    left: 30px;
    font-size: 24px;
    cursor: pointer;
    color: white;
    transition: 0.2s;
}

.close-btn:hover {
    color: red;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
}

.button-group {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 20px;
}

.flower-button, .buy-button {
    font-size: 1.2rem;
    padding: 10px 20px;
    border: none;
    margin-left: 60px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease-in-out, transform 0.2s ease-in-out;
}

.flower-button {
    background: linear-gradient(110deg, white, #d94f70);
    color: white;
    font-size: 17px;
    padding: 5px 5px;
}

.flower-button:hover {
    background: linear-gradient(90deg, #ff0040, #ff007f);
    transform: scale(1.05);
}

.buy-button {
    background: linear-gradient(135deg, black, darkblue, white);
    color: white;
    font-size: 17px;
    padding: 5px 5px;
}

.buy-button:hover {
    background: linear-gradient(135deg, black, violet, white);
    transform: scale(1.05);
}

.buy-button:active, .flower-button:active {
    transform: scale(0.95);
}



.cinematic-thrift-store {
    background-color: white; /* Dark background for a cinematic feel */
    color: grey; /* Light text for contrast */
    padding: 2rem;
    border-shadow: 20px;
    font-family: 'Playfair Display', serif; /* Elegant serif font */
}

.section-title {
    font-size: 2.0rem;
    text-align: center;
    color: black; /* Golden hue for a luxurious touch */
    margin-bottom: 1.5rem;
}

.posts-section {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
}

.cinematic-card {
    background-color: #252525; /* Slightly lighter than the background */
    border: 1px solid #444;
    border-radius: 10px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
}

.cinematic-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5);
}

.card-image-container {
    overflow: hidden;
    height: 250px;
}



.cinematic-card:hover .card-image {
    transform: scale(1.1);
    width: 70%;
}

.card-content {
    padding: 1rem;
}

.card-title {
    font-size: 1.5rem;
    margin: 0.5rem 0;
    color: #f5e1a4;
}

.card-description {
    font-size: 1rem;
    margin: 0.5rem 0;
    color: #ccc;
}

.card-price {
    font-size: 1.2rem;
    color: #f5e1a4;
    font-weight: bold;
}

.empty-message {
    text-align: center;
    font-size: 1.2rem;
    color: #888;
    margin-top: 2rem;
}

/* Sidebar styles */
        .sidebar {
            position: fixed;
            top: 8%;
            left: 0;
            width: 50px; /* Collapsed state */
            height: 100vh;
            background: white;
            color: black;
            padding: 20px;
            transition: width 0.3s ease-in-out;
            overflow: hidden;
            z-index: 999;
        }

        .sidebar.expanded {
            width: 250px; /* Expanded state */
        }
        .sidebar.active {
            left: 50px;
        }

        .sidebar .menu-items a {
            display: flex;
            align-items: center;
            padding: 10px;
            color: #333;
            text-decoration: none;
            font-size: 18px;
            white-space: nowrap;
        }

        .sidebar .menu-items a i {
            margin-right: 5px;
            min-width: 20px; /* Ensures space for icon */
        }

            .sidebar .menu-items a span {
                display: inline; /* Show text by default */
            }

            .sidebar:not(.expanded) .menu-items a span {
                display: none; /* Hide text when collapsed */
            }

            .sidebar .menu-items a:hover {
                background-color: #e0e0e0;
            }

        /* Button styles */
        .menu-btn {
            position: absolute;
            top: 5px;
            right: 10%;
            background: #333;
            color: black;
            padding: 10px 15px;
            border: none;
            cursor: pointer;
        }
        .close-btn {
            background: none;
            color: red;
            border: none;
            font-size: 25px;
            cursor: pointer;
            float: right;
        }

      .menu-items {
            margin-top: 30px;
        }
        .menu-items a {
            display: block;
            color: black;
            text-decoration: none;
            padding: 10px 0;
        }
        .menu-items a:hover {
            background: #444;
        }

      .icon {
        font-size: 20px;  /* Adjust icon size */
        color: black;     /* Icon color */
        margin-right: 10px; /* Space between icon and text */
        }

        /* Hide the text by default */
        .link-text {
            display: inline;  /* Make text visible by default */
        }

        /* When sidebar is hidden, hide the text */
        .sidebar-hidden .link-text {
            display: none;  /* Hide the text */
        }

        /* Ensure icons are visible when the sidebar is hidden */
        .sidebar-hidden .menu-items a {
            text-align: center;  /* Center the icons when sidebar is collapsed */
        }
      .artwork-title {
    font-size: 1.5rem;
    font-weight: 600;
    letter-spacing: 0.5px;
    color: black; /* Bright white for cinematic contrast */
    margin-bottom: 8px;
}





.meta-value {
    font-size: 10px;
    font-weight: 500;
    text-transform: lowercase;
    letter-spacing: 0.8px;
}

.modal-disc{
    flex-direction: column;
    max-width: 100%;
    padding: 0px 30px;
}


    .logo {
        text-align: left;
        flex-grow: 1;
        font-size: 1.5em;
    }
    .menu-btn {
        background: none;
        border: none;
        color: white;
        font-size: 1.5em;
        cursor: pointer;
        display: none;
    }


    @media (max-width: 772px) {
        .logo{
            text-align: center;
        }


        nav {
    display: none;
  }
        .nav-links a {
            display: none;
            margin: 15px 0;
        }
        .menu-btn {
            display: block;
        }

.artwork-gallery {
    grid-template-columns: repeat(auto-fit, minmax(100%, 1fr));
    gap: 15px;
    padding: 0 -13%;

  }

  .artwork-card {
    max-width: 100%;
    font-size: 8px;
  }

  modal-content{

  }
@media (max-width: 772px) {
    .artwork-gallery {
        grid-template-columns: repeat(auto-fit, minmax(100%, 1fr));
        gap: 15px;
    }
    .artwork-card {
        max-width: 100%;
    }

  .buttons-container {
    flex-direction: column;
  }

  .flower-button, .buy-button {
    width: 20%;
  }

  .artist-page {
    padding: 2rem;

}


.artist-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 2rem;
}

.artist-card {
    background-color: #2a2a2a;
    padding: 1rem;
    border-radius: 10px;
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    opacity: 0;
    animation: fadeIn 0.5s ease-in forwards;
}

.artist-card:hover {
    transform: scale(1.05);
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
}

.artist-icon {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 1rem;
}

.artist-name {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
    font-family: 'Montserrat', sans-serif;
    color: #f0f0f0;
}

.artist-meta {
    font-size: 0.9rem;
    color: #888;
    margin-top: 0.5rem;
}

.time-ago, .wallet-address {
    color: #f0f0f0;
    font-weight: bold;
}

.artist-name i {
    font-size: 1.2rem;
    margin-left: 0.5rem;
    color: #f0f0f0;
}

.artist-tagline, .artist-bio {
    font-size: 1rem;
    font-family: 'Roboto', sans-serif;
    color: #cccccc;
}

.bio-card {
    grid-column: span 2;
}

.empty-message {
    grid-column: 1 / -1;
    text-align: center;
    font-size: 1.2rem;
    color: #888;
}

.artist-card:nth-child(1) { animation-delay: 0.1s; }
.artist-card:nth-child(2) { animation-delay: 0.2s; }
.artist-card:nth-child(3) { animation-delay: 0.3s; }
.artist-card:nth-child(4) { animation-delay: 0.4s; }

@keyframes fadeIn {
    to {
        opacity: 1;
    }
    }







  </style>
</head>
<body>
  <div class="header-container">

        <button class="menu-btn" onclick="toggleSidebar()">
        ☰
    </button>

    <header>

          <div class="logo">Controlled.  Motives</div>

          <nav>
            <button class="search-btn" onclick="toggleSidebar()">
              <svg xmlns="http://www.w3.org/2000/svg" width="17" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="26" x2="16.65" y2="16.75"></line>
              </svg>

            </button>

              <!-- Sidebar -->





            <a href="{% url 'profiles:home' %}"><i class="fas fa-home"></i> Home</a>
            <a href="{% url 'profiles:gallery' %}"><i class="fas fa-images"></i> Gallery</a>
            <a href="{% url 'profiles:artist' %}"><i class="fas fa-paint-brush"></i> Artist</a>


          </nav>

        <div class="sidebar" id="sidebar">
            <button class="menu-btn" onclick="toggleSidebar()">
                ☰
            </button>

            <div class="menu-items">
                <a href="#" id="profile-link"><i class="fas fa-user icon"></i> <span class="link-text">Profile</span></a>
                <a href="{% url 'profiles:wallet_page' %}"><i class="fas fa-wallet icon"></i> <span class="link-text">Your Blockchain Wallet</span></a>
                <a href="{% url 'profiles:transaction_history' %}"><i class="fas fa-exchange-alt icon"></i> <span class="link-text">Nft Transactions</span></a>
                <a href="{% url 'profiles:send_eth' %}"><i class="fas fa-paper-plane icon"></i> <span class="link-text">Send Ethereum</span></a>
                <a href="{% url 'profiles:about' %}"><i class="fas fa-info-circle"></i> <span class="link-text"> About</span></a>
                <a href="{% url 'profiles:subscriptions' %}"><i class="fas fa-bell icon"></i> <span class="link-text">Subscribe</span></a>
                <a href="#" style="color: red;"><i class="fas fa-sign-out-alt icon"></i> <span class="link-text">Logout</span></a>
            </div>
        </div>


    </header>
  </div>
  <section class="hero">
    <h1>Welcome to Controlled Motives</h1>
    <p>Explore the finest artistic expressions, thoughtfully curated for a captivating experience.</p>

    <a href="{% url 'profiles:gallery' %}">
        <button>Explore The Gallery</button>
    </a>
  </section>



<section class="section">
    <h2>Trending Artworks</h2>
    <div class="artwork-gallery">
        {% for artwork in artworks %}
            <div class="artwork-card" onclick="openModal({
                image: '{{ artwork.image.url }}',
                title: '{{ artwork.title|escapejs }}',
                description: '{{ artwork.description|escapejs }}',
                flowers: '{{ artwork.total_flowers }}',
                price: '{{ artwork.price }}',
                created_at: '{{ artwork.created_at|date:"c" }}'
            })">
                <img src="{{ artwork.image.url }}" alt="{{ artwork.title }}">
                <div class="artwork-details">
                    <div class="buttons-container">
                        <button class="flower-button" data-artwork-id="{{ artwork.id }}">
                            {% if user in artwork.flowers.all %}
                                🌸 Remove Flower
                            {% else %}
                                💮 Give Flower
                            {% endif %}
                        </button>
                        <span id="flowers-count-{{ artwork.id }}">{{ artwork.total_flowers }}</span>
                    </div>
                    <div class="artwork-info">
        <h3 class="artwork-title">{{ artwork.title }}</h3>
        <p class="artwork-description">{{ artwork.description }}</p>
        <div class="artwork-meta">
            <span class="meta-item">
                <i class="fas fa-calendar-alt"></i> {{ artwork.created_at|date:"F d, Y" }}
            </span>
            <span class="meta-item">
                <i class="fas fa-flower-tulip"></i> <span id="flower-count-{{ artwork.id }}">{{ artwork.total_flowers }}</span>
            </span>
        </div>
                    </div>
                </div>
            </div>
        {% empty %}
            <p>No artworks found.</p>
        {% endfor %}
    </div>

    <!-- Artwork Modal -->
    <div id="artworkModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <img id="modalImage" src="" alt="Artwork Image">
            <div class="modal-disc">
                <h3 id="modalTitle"></h3>
                <p id="modalDescription"></p>
                <p><strong>🌹:</strong> <span id="modalFlowers"></span></p>
                <p><strong>Price:</strong> <span id="modalPrice"></span></p>
                <p><strong>Minted at:</strong> <span id="modalCreatedAt"></span></p>
                <div id="modalBlockchain"></div>
            </div>
        </div>
    </div>
</section>


    <!-- Modal Structure -->



  <!--<section id="thriftstore" class="cinematic-thrift-store">
    <h2 class="section-title">JustPray Thrift Store</h2>
    <div data-id="image-section" class="posts-section active">
        {% for item in thrift_store_items %}
        <a href="{% url 'profiles:thrift_item_detail' item_id=item.id %}" class="card cinematic-card">
            <div class="card-image-container">
                <img src="{{ item.image.url }}" alt="{{ item.name }}">
            </div>
            <div class="card-content">
                <h3 class="card-title">{{ item.name }}</h3>
                <p class="card-description">{{ item.description }}</p>
                <p class="card-price">${{ item.price }}</p>
            </div>
        </a>
        {% empty %}
        <p class="empty-message">No thrift store items available at the moment.</p>
        {% endfor %}
    </div>
</section>
-->


  <footer>
    <p>&copy; 2025 Controlled Motives. All rights reserved.</p>
  </footer>
<script>

    document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.time-ago').forEach(span => {
                const date = new Date(span.dataset.time);
                const now = new Date();
                const seconds = Math.floor((now - date) / 1000);
                let interval = Math.floor(seconds / 31536000); // Years
                if (interval > 1) return span.textContent = `${interval} years ago`;
                interval = Math.floor(seconds / 2592000); // Months
                if (interval > 1) return span.textContent = `${interval} months ago`;
                interval = Math.floor(seconds / 86400); // Days
                if (interval > 1) return span.textContent = `${interval} days ago`;
                interval = Math.floor(seconds / 3600); // Hours
                if (interval > 1) return span.textContent = `${interval} hours ago`;
                interval = Math.floor(seconds / 60); // Minutes
                if (interval > 1) return span.textContent = `${interval} min ago`;
                span.textContent = 'just now';
            });
        });

    document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".flower-button").forEach(button => {
        button.addEventListener("click", function () {
            let artworkId = this.dataset.artworkId;
            let flowerCount = document.querySelector(`#flower-count-${artworkId}`);

            fetch(`/toggle-flower/${artworkId}/`, {
                method: "POST",
                headers: {
                    "X-CSRFToken": getCookie("csrftoken"),
                    "Content-Type": "application/json"
                },
                credentials: "same-origin"
            })
            .then(response => response.json())
            .then(data => {
                if (data.flowered) {
                    this.innerText = "🌸 Remove Flower";
                } else {
                    this.innerText = "💮 Give Flower";
                }
                flowerCount.innerText = data.total_flowers;
            })
            .catch(error => console.error("Error:", error));
        });
    });
});

    // Function to get CSRF token for AJAX requests
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            let cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                let cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }


    const userId = 2; // Replace this with the actual user ID dynamically
    document.getElementById("profile-link").href = `http://127.0.0.1:8000/profiles/profiles/${userId}/`;

    function toggleSearch() {
        document.querySelector('.search-container').classList.toggle('active');
    }
    function toggleSidebar() {
        document.querySelector('.sidebar').classList.toggle('sidebar-hidden');
    }

    function toggleSearch() {
        document.querySelector('.search-container').classList.toggle('active');
    }

     function toggleSidebar() {
            document.getElementById("sidebar").classList.toggle("active");
        }
            function openModal() {
            document.body.classList.add("modal-open"); // Prevent background scroll
            document.getElementById("myModal").style.display = "block"; // Show modal
        }

        function closeModal() {
            document.body.classList.remove("modal-open");3 // Re-enable background scroll
            document.getElementById("myModal").style.display = "none"; // Hide modal
        }

    function buyArtwork(artworkId) {
    window.location.href = `/profiles/buy_artwork/${artworkId}/`;
    }

    function openModal(image, title, description, flowers, price, createdAt) {
    document.getElementById("modalImage").src = image;
    document.getElementById("modalTitle").textContent = title;
    document.getElementById("modalDescription").textContent = description;
    document.getElementById("modalFlowers").textContent = flowers;
    document.getElementById("modalPrice").textContent = price;
    document.getElementById("modalCreatedAt").textContent = createdAt;

    document.getElementById("artworkModal").style.display = "flex";
}

function closeModal() {
    document.getElementById("artworkModal").style.display = "none";
}




  document.addEventListener("DOMContentLoaded", function () {
    const searchContainer = document.querySelector(".search-container");
    const searchBtn = document.querySelector(".search-btn");

    searchBtn.addEventListener("click", function () {
      searchContainer.classList.toggle("active");
    });
  });


<!--function openModal(artwork) {
    // Get modal elements
    document.getElementById("modalImage").src = artwork.image;
    document.getElementById("modalTitle").textContent = artwork.title;
    document.getElementById("modalDescription").textContent = artwork.description;
    document.getElementById("modalFlowers").textContent = artwork.flowers;
    document.getElementById("modalPrice").textContent = artwork.price ? `$${artwork.price}` : "Not for sale";
    document.getElementById("modalCreatedAt").textContent = artwork.created_at || "Unknown";
    document.getElementById("artworkModal").style.display = "flex";
    document.getElementById('modalCreatedAt').textContent = artwork.created_at || 'Unknown';

    // Blockchain Data
    const blockchainSection = document.getElementById('modalBlockchain');
    if (artwork.is_tokenized && artwork.blockchain_network && artwork.blockchain_txn_hash && artwork.blockchain_address) {
        blockchainSection.innerHTML = `
            <p><strong>Tokenized on Blockchain:</strong> ✅</p>
            <p><strong>Network:</strong> ${artwork.blockchain_network}</p>
            <p><strong>Transaction Hash:</strong>
                <a href="https://etherscan.io/tx/${artwork.blockchain_txn_hash}" target="_blank">
                    ${artwork.blockchain_txn_hash.slice(0, 10)}... (View)
                </a>
            </p>
            <p><strong>Stored at Address:</strong> ${artwork.blockchain_address}</p>
        `;
    } else {
        blockchainSection.innerHTML = `<p><strong>Not Tokenized Yet</strong></p>`;
    }

    // Show Modal
    const relativeTime = timeSince(artwork.created_at);
    document.getElementById("modalCreatedAt").textContent = relativeTime;

    document.getElementById("artworkModal").style.display = "flex";
}

function closeModal() {
    document.getElementById('artworkModal').style.display = 'none';
}

// Close modal if clicking outside the content
window.onclick = function(event) {
    let modal = document.getElementById('artworkModal');
    if (event.target === modal) {
        closeModal();
    }
};-->



        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll(".flower-button").forEach(button => {
                button.addEventListener("click", function (e) {
                    e.stopPropagation(); // Prevent modal opening on button click
                    if (this.disabled) return;

                    // Disable button and show loading state
                    this.disabled = true;
                    const originalText = this.innerText;
                    this.innerText = "Processing...";

                    const artworkId = this.dataset.artworkId;
                    const flowerCount = document.querySelector(`#flower-count-${artworkId}`);

                    fetch(`/toggle-flower/${artworkId}/`, {
                        method: "POST",
                        headers: {
                            "X-CSRFToken": getCookie("csrftoken"),
                            "Content-Type": "application/json"
                        },
                        credentials: "same-origin"
                    })
                    .then(response => {
                        if (!response.ok) throw new Error("Network response was not ok");
                        return response.json();
                    })
                    .then(data => {
                        if (data.flowered) {
                            this.innerText = "🌸 Remove Flower";
                        } else {
                            this.innerText = "💮 Give Flower";
                        }
                        flowerCount.innerText = data.total_flowers;
                    })
                    .catch(error => {
                        console.error("Error:", error);
                        alert("An error occurred while processing your request.");
                        this.innerText = originalText; // Revert text on error
                    })
                    .finally(() => {
                        this.disabled = false; // Re-enable button
                    });
                });
            });
        });

        // Helper function to get CSRF token
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== "") {
                const cookies = document.cookie.split(";");
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + "=")) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Function to calculate relative time
        function timeSince(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const seconds = Math.floor((now - date) / 1000);
            let interval = Math.floor(seconds / 31536000); // Years

            if (interval > 1) {
                return interval + " years ago";
            }
            interval = Math.floor(seconds / 2592000); // Months
            if (interval > 1) {
                return interval + " months ago";
            }
            interval = Math.floor(seconds / 86400); // Days
            if (interval > 1) {
                return interval + " days ago";
            }
            interval = Math.floor(seconds / 3600); // Hours
            if (interval > 1) {
                return interval + " hours ago";
            }
            interval = Math.floor(seconds / 60); // Minutes
            if (interval > 1) {
                return interval + " min ago";
            }
            return "just now";
        }
</script>

</body>
</html>
